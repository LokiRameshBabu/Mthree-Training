# SQL Guide

## Introduction
SQL (Structured Query Language) is a powerful tool used for managing and manipulating relational databases. This guide covers essential SQL concepts, including foreign keys, primary keys, candidate keys, ER diagrams, normalization, dependencies, and stored procedures.

---

## 1. Foreign Key
A **FOREIGN KEY** constraint prevents actions that would break relationships between tables. It references a **PRIMARY KEY** in another table.

Example:
```sql
CREATE TABLE Department (
    dept_id INT PRIMARY KEY,
    dept_name VARCHAR(100)
);

CREATE TABLE Employee (
    emp_id INT PRIMARY KEY,
    emp_name VARCHAR(100),
    dept_id INT,
    FOREIGN KEY (dept_id) REFERENCES Department(dept_id)
);
```

![Foreign Key](https://www.programiz.com/sites/tutorial2program/files/foreign-key.png)

---

## 2. Primary Key
A **PRIMARY KEY** uniquely identifies each record in a table. It must contain **UNIQUE** values and **cannot** be NULL.

Example:
```sql
CREATE TABLE Students (
    student_id INT PRIMARY KEY,
    student_name VARCHAR(100)
);
```

![Primary Key](https://example.com/primary_key_image.png)

---

## 3. Candidate Key
A **Candidate Key** uniquely identifies a row and follows:
- **Uniqueness**
- **Minimality**
- **Stability**

Example:
```sql
CREATE TABLE Students (
    student_id INT,
    email VARCHAR(100),
    phone_number VARCHAR(15),
    PRIMARY KEY (student_id),
    UNIQUE (email, phone_number)
);
```

---

## 4. ER Diagram
An **Entity-Relationship (ER) Diagram** visually represents relationships between database tables.

**Entities**:
- **Strong Entity**: Exists independently, has a **Primary Key**.
- **Weak Entity**: Depends on a strong entity, has no **Primary Key**.

**Attributes**:
| Attribute Type | Description | Example |
|---------------|-------------|---------|
| **Key Attribute** | Uniquely identifies an entity | `student_id` |
| **Composite Attribute** | Contains multiple sub-attributes | `address (street, city, state)` |
| **Multivalued Attribute** | Can hold multiple values | `skills (Java, Python)` |
| **Derived Attribute** | Derived from another attribute | `age (from dob)` |

![ER Diagram](https://example.com/er_diagram.png)

---

## 5. Normalization
Normalization reduces **redundancy** and improves **data integrity**.

| Normal Form | Description | Fix |
|------------|-------------|---------|
| **1NF** | No repeating values | Split into separate rows |
| **2NF** | No partial dependencies | Move dependent attributes |
| **3NF** | No transitive dependencies | Create a separate table |
| **BCNF** | Every determinant is a candidate key | Restructure table |

![Normalization](https://example.com/normalization_image.png)

---

## 6. Dependencies
1. **Functional Dependency**: One column determines another.
   ```sql
   emp_id â†’ emp_name
   ```
2. **Partial Dependency**: A non-key attribute depends on **part** of a composite key.
3. **Transitive Dependency**: A non-key attribute depends on another **non-key** attribute.
4. **Multivalued Dependency**: One attribute determines multiple values of another.
5. **Join Dependency**: A table can be split into multiple tables **without data loss**.

---

## 7. Stored Procedure
A **Stored Procedure** is precompiled SQL code stored in the database for reuse.

**Why use DELIMITER?**
- In SQL, the default statement separator is `;`.
- However, stored procedures contain multiple statements.
- Using `DELIMITER` helps define a **custom separator** to avoid conflicts.
- Once the procedure is created, `DELIMITER ;` resets it to default.

### Code Explanation:
```sql
DELIMITER //
CREATE PROCEDURE sp_insert_student(
    IN p_first_name VARCHAR(50),
    IN p_last_name VARCHAR(50),
    IN p_email VARCHAR(100)
)
BEGIN
    -- Insert new student record
    INSERT INTO students (first_name, last_name, email) 
    VALUES (p_first_name, p_last_name, p_email);
    
    -- Return the newly inserted Student ID
    SELECT LAST_INSERT_ID() AS STUDENT_ID;
END //
DELIMITER ;
```

**Explanation:**
1. `DELIMITER //` - Changes the default statement separator to `//` to allow multi-line statements inside the procedure.
2. `CREATE PROCEDURE sp_insert_student(...)` - Defines a stored procedure that takes three input parameters.
3. `BEGIN ... END` - Defines the body of the procedure.
4. `INSERT INTO students (...) VALUES (...)` - Inserts a new student record into the `students` table.
5. `SELECT LAST_INSERT_ID() AS STUDENT_ID;` - Retrieves the ID of the last inserted record.
6. `END //` - Marks the end of the procedure.
7. `DELIMITER ;` - Resets the delimiter back to `;`.

![Stored Procedure](https://example.com/stored_procedure.png)

---

## 8. Practice Problems
1. Create a **Students** table with a **Foreign Key** reference to a **Courses** table.
2. Normalize an **Orders** table to **3NF**.
3. Implement a **Stored Procedure** to insert employee data.

---

## Author
[Lokeswari](https://github.com/LokiRameshBabu/c406firstproject)

---

> *Note: Replace the placeholder image URLs with actual image links before using.*
